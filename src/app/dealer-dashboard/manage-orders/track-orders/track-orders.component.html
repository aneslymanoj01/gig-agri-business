<div class="track-orders-page">
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-content">
      <div class="breadcrumb">
        <span class="breadcrumb-item">Dashboard</span>
        <mat-icon class="breadcrumb-separator">chevron_right</mat-icon>
        <span class="breadcrumb-item" (click)="goBack()">Manage Orders</span>
        <mat-icon class="breadcrumb-separator">chevron_right</mat-icon>
        <span class="breadcrumb-item active">Track Orders</span>
      </div>
      <h1 class="page-title">
        <mat-icon class="title-icon">track_changes</mat-icon>
        Track Orders
      </h1>
    </div>
  </div>

  <div class="content-container">

  <!-- Search Section -->
  <div class="search-card">
    <div class="search-content">
      <div class="search-field">
        <label>Order ID</label>
        <input 
          type="text" 
          [(ngModel)]="orderId" 
          placeholder="Enter order ID"
          (keyup.enter)="searchOrder()"
        >
      </div>
      <button 
        class="search-btn" 
        (click)="searchOrder()" 
        [disabled]="loading"
      >
        {{ loading ? 'Searching...' : 'Search' }}
      </button>
    </div>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="error-message">
    {{ error }}
  </div>

  <!-- Tracking Results -->
  <div *ngIf="trackingData" class="tracking-results">
    <!-- Order Summary -->
    <div class="order-summary-card">
      <h3>Order #{{ trackingData.orderId }}</h3>
      <div class="summary-grid">
        <div class="summary-item">
          <span class="label">Status:</span>
          <span class="status-badge" [class]="'status-' + trackingData.status.toLowerCase()">
            {{ trackingData.status }}
          </span>
        </div>
        <div class="summary-item">
          <span class="label">Total Amount:</span>
          <span class="value">LKR {{ trackingData.orderDetails.totalAmount }}</span>
        </div>
        <div class="summary-item">
          <span class="label">Items:</span>
          <span class="value">{{ trackingData.orderDetails.itemCount }}</span>
        </div>
      </div>
    </div>

    <!-- Delivery Info -->
    <div class="delivery-info-card" *ngIf="trackingData.deliveryInfo">
      <h4>Delivery Information</h4>
      <div class="delivery-grid">
        <div class="delivery-item">
          <span class="label">Driver:</span>
          <span class="value">{{ trackingData.deliveryInfo.driverName }}</span>
        </div>
        <div class="delivery-item">
          <span class="label">Phone:</span>
          <span class="value">{{ trackingData.deliveryInfo.driverPhone }}</span>
        </div>
        <div class="delivery-item">
          <span class="label">Estimated Delivery:</span>
          <span class="value">{{ trackingData.deliveryInfo.estimatedDelivery }}</span>
        </div>
      </div>
      <div class="address">
        <span class="label">Delivery Address:</span>
        <p>{{ trackingData.orderDetails.deliveryAddress }}</p>
      </div>
    </div>

    <!-- Workflow Progress -->
    <div class="workflow-card">
      <h4>Order Progress</h4>
      <div class="workflow-timeline">
        <div 
          *ngFor="let step of getWorkflowSteps(); let i = index" 
          class="timeline-step"
          [class.completed]="step.status === 'COMPLETED'"
          [class.pending]="step.status === 'PENDING'"
        >
          <div class="step-indicator">
            <div class="step-circle">
              <mat-icon *ngIf="step.status === 'COMPLETED'">check</mat-icon>
              <span *ngIf="step.status === 'PENDING'">{{ i + 1 }}</span>
            </div>
            <div *ngIf="i < getWorkflowSteps().length - 1" class="step-line"></div>
          </div>
          <div class="step-content">
            <h5>{{ step.label }}</h5>
            <p class="step-description">{{ step.description }}</p>
            <span *ngIf="step.timestamp" class="step-timestamp">
              {{ formatTimestamp(step.timestamp) }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
